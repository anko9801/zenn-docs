---
title: ""
emoji: "ğŸ—‚"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: []
published: false
---

Weil pairing ã®è¨ˆç®—ã¯æ¯”è¼ƒçš„é…ãã¦ã€ã“ã®ä¸Šä½äº’æ›ã¨ã—ã¦ Tate-Lichtenbaum Pairing ã¨ã„ã†ãƒšã‚¢ãƒªãƒ³ã‚°ãŒã‚ã‚Šã¾ã™ã€‚

> **Def. Tate-Lichtenbaum Pairing**
> æ¥•å††æ›²ç·š $E/K$ ã«å¯¾ã— æ•´æ•° $m$
> $P\in E(K)$ ã¨ $T\in E(K)[m]$ $Q\in E(\overline{K})$ $mQ = P$
>
> $$
G_{\overline{K}/K}\to \mu_m \\
\sigma\mapsto e_m(Q^\sigma - Q, T)
$$
>
> $$
\begin{aligned}
& \tau: \frac{E(K)}{mE(K)}\times E(K)[m] \to \frac{K^\times}{(K^\times)^m} \\
& \tau(P, T) = f(P)\bmod (K^\times)^m
\end{aligned}
$$
>
> $$
K^\times/(K^\times)^m\to H^1(G_{\overline{K}/K}, \mu_m)
$$

> **Prop.**
> Tate-Lichtenbaum Pairing ã¯ãƒšã‚¢ãƒªãƒ³ã‚°ã§ã‚ã‚‹

**Proof.**
$\xi(\sigma) = e_m(Q^\sigma - Q, T)$ ã¯ $\xi: G_{\overline{K}/K}\to\mu_m$

$$
\begin{aligned}
\xi(\sigma\tau)
\end{aligned}
$$

$$
e_n(Q^\sigma - Q, T) = \frac{\sqrt[n]{\alpha}^\sigma}{\sqrt[n]{\alpha}} \qquad \forall \sigma\in G_{\overline{K}/K} \\
\tau(P, T) = \alpha \bmod (K^\times)^n
$$

## åŒç¨®å†™åƒæš—å·

> **åŒç¨®å†™åƒã®è¨ˆç®—å›°é›£æ€§**
> æ¥•å††æ›²ç·š $E$ ã¨åŒç¨®å†™åƒ $\phi$ ã‚’ç”Ÿæˆã—ã€å…¬é–‹æƒ…å ± $(E, \phi(E))$ ã‹ã‚‰ç§˜å¯†æƒ…å ± $(E, \phi)$ ã‚’æ±‚ã‚ã‚‹ã®ãŒè¨ˆç®—é‡çš„ã«å›°é›£ã§ã‚ã‚‹ã¨ã„ã†ä»®å®š

ã­ã˜ã‚Œç‚¹ã®ã¨ã‚Šã‚„ã™ã•ã‹ã‚‰åŒç¨®å†™åƒæš—å·ã§ã¯è¶…ç‰¹ç•°æ›²ç·šã‚’åˆ©ç”¨ã—ã¾ã™ã€‚
é€šå¸¸æ›²ç·šã‚’ä½¿ã£ãŸæ–¹å¼ã‚‚ã‚ã‚‹ãŒã©ã‚Œã‚‚éåŠ¹ç‡
ãƒ¢ãƒ³ãƒˆã‚´ãƒ¡ãƒªãƒ¼ãƒ¢ãƒ‡ãƒ«

ãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚ºãŒå°ã•ã„
$\mathbb{F}_{p^2}$ ä¸Šã®è¶…ç‰¹ç•°æ¥•å††æ›²ç·š $E$
$\#E_0(\mathbb{F}_{p^2}) = (p + 1)^2$

### åŒç¨®å†™åƒ

> **Def. åŒç¨®å†™åƒ**
> æ¥•å††æ›²ç·š $E_1, E_2$ ã«å¯¾ã—ã¦æœ‰ç†å¤šé …å¼ã§è¡¨ã›ã‚‹ç¾¤æº–åŒå‹å†™åƒ $f: E_1 â†’ E_2$ ã‚’åŒç¨®å†™åƒã¨ã‚ˆã¶ã€‚
> æœ‰ç†å¤šé …å¼ã®æ¬¡æ•°ãŒ $l$ ã®ã¨ã $l$-åŒç¨®å†™åƒã¨ã„ã†ã€‚
> ã¾ãŸæœ‰ç†å¤šé …å¼ $\hat{f}: E_2\to E_1$ åŒå¯¾åŒç¨®å†™åƒã¨ã„ã†ã€‚

åŒç¨®å†™åƒã®å¤‰æ›ã«å¯¾ã—ã¦ä½æ•°ãŒä¸å¤‰ãªã®ã¨åŒæ§˜ã« $j$-ä¸å¤‰é‡ã‚‚ä¸å¤‰ã¨ãªã‚Šã¾ã™ã€‚

> **Thm. Tate ã®å®šç†**
> æ¥•å††æ›²ç·š $E_1, E_2$ ã«å¯¾ã—ã¦åŒç¨®ã¨ $\#E_1 = \#E_2$ ã¯åŒå€¤

> **Def. $j$-ä¸å¤‰é‡**
>
> $$
j_E = 1728\frac{4a^3}{4a^3 + 27b^2}
$$

æ¥•å††æ›²ç·šåŒå£«ã®åŒå‹å†™åƒã‚’å…·ä½“çš„ã«è¨ˆç®—ã™ã‚‹æ–¹æ³•

https://eprint.iacr.org/2011/430.pdf

> **Thm. VÃ©lu ã®å…¬å¼**
> æ¥•å††æ›²ç·š $E$, $E'$ ã«åˆ†é›¢çš„ãªåŒå‹å†™åƒ $\phi: E\to E'$ ãŒå¼µã‚‰ã‚Œã¦ã„ã‚‹ã¨ãã€æº–åŒå‹å®šç†ã‚ˆã‚Š $E' = E/\ker\phi$ ã¨ãªã‚Šã¾ã™ã€‚$\phi$ ã®æ ¸ $F = \ker\phi$ ã®åˆ†å‰²ã‚’ $F = \lbrace\mathcal{O}\rbrace\cup F^+ \cup F^-$ ã¨ã™ã‚‹ã¨
>
> $$
E/F: y^2 = x^3 + (a - 5v)x + (b - 7w)
$$
>
> $$
\phi(x, y) = \left(x + \sum_{P\in F^+}\frac{v_P}{x - x_P} - \frac{u_P}{(x - x_P)^2}, y - \sum_{P\in F^+}\frac{2u_Py}{(x - x_P)^3} - v_P\frac{y - y_P - g_P^xg_P^y}{(x - x_P)^2}\right)
$$

**Proof.**
Laurent å±•é–‹
$\Box$

ãƒ¢ãƒ³ãƒˆã‚´ãƒ¡ãƒªãƒ¼ãƒ¢ãƒ‡ãƒ«ã§ã¯ Costello-Hisil ã®å…¬å¼

### åŒç¨®å†™åƒæš—å·

è¶…ç‰¹ç•°åŒç¨®å†™åƒ Diffie-Hellman éµå…±æœ‰
SIDH (Supersingular Isogeny Diffie-Hellman key exchange)
$p = l_A^{e_A}l_B^{e_B} - 1$
CSIDH (Commutative Supersingular Isogeny Diffie-Hellman)
$p = l_1l_2\cdots l_n - 1$
$n$-åŒç¨®å†™åƒã®è¨ˆç®—é‡ã¯ $\mathcal{O}(n)$ æ›ã‹ã‚Šã¾ã™ã€‚æ¬¡æ•° $2^{256}$ ç¨‹åº¦ã®åŒç¨®å†™åƒè¨ˆç®—ã‚’ã™ã‚‹
ã“ã®æ¥•å††æ›²ç·šã‚’ç”Ÿæˆã™ã‚‹ã®ã« 1700 CPUæ™‚é–“ä½¿ã£ãŸã‚‰ã—ã„ã§ã™ã€‚

SIKE (Supersingular Isogeny Key Encapsulation)

$$
y^2 = x^3 + x \qquad y^2 = x^3 + 6x^2 + x
$$

```python
# SIKEp377
p = 2^191 * 3^117 - 1
# SIKEp546
p = 2^273 * 3^172 - 1
# SIKEp697
p = 2^356 * 3^215 - 1

Fp2<I> = GF(p, 2)
assert I^2 == -1
R<x> = PolynomialRing(Fp2)
E = EllipticCurve(x^3 + x)
E = EllipticCurve(x^3 + 6*x^2 + x)
```

> **Thm. Kani's theorem**

https://eprint.iacr.org/2022/975

[Kani for begginers](https://www.math.auckland.ac.nz/~sgal018/kani.pdf)

https://ellipticnews.wordpress.com/2022/08/12/attacks-on-sidh-sike/
https://github.com/GiacomoPope/Castryck-Decru-SageMath

## è¶…æ¥•å††æ›²ç·š
ãƒ¤ã‚³ãƒ“å¤šæ§˜ä½“
Mumford è¡¨ç¾

$$
y^2 + h(x)y = f(x)
$$

> **Def. è¶…æ¥•å††æ›²ç·šã¨ãã®ç¾¤**
> $K$ ã‚’ä½“ã€$f(x)\in K[x]$ ã‚’ $\deg f = 2g + 1$ ã®é‡æ ¹ã‚’æŒãŸãªã„ãƒ¢ãƒ‹ãƒƒã‚¯å¤šé …å¼ã¨ã—ãŸã¨ãã« $C: y^2 = f(x)$ ã‚’ç¨®æ•° $g$ ã®è¶…æ¥•å††æ›²ç·šã¨ã„ã†ã€‚
>
> $$
C: y^2 = x^{2g+1} + a_{2g}x^{2g} + \cdots + a_1x + a_0
$$
>
> ã“ã‚Œã‚’æº€è¶³ã™ã‚‹ $P = (x, y)$ ã¨å”¯ä¸€ã®ç„¡é™é ç‚¹ $P_\infty$ ã‚’åˆã‚ã›ã¦ $C$ ä¸Šã®ç‚¹ã¨ã„ã„ $P\in C$ ã¨ã‹ãã€‚

> **åŠ ç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **
> ã¾ãš $d = \gcd(u_1, u_2, v_1 + v_2 + h) = s_1u_1 + s_2u_2 + s_3(v_1 + v_2 + h)$ ã‚’è¨ˆç®—ã—ã€æ¬¡ã®ã‚ˆã†ã«åŠ ç®—ã‚’è¡Œã†ã€‚
>
> $$
\begin{aligned}
u & = \frac{u_1u_2}{d^2} \\
v & = \frac{s_1u_1v_2 + s_2u_2v_1 + s_3(v_1v_2 + f)}{d} & \pmod u
\end{aligned}
$$

> **é‚„å…ƒã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ **
> $\deg u > g$ ãªã‚‰æ¬¡ã®ã‚ˆã†ã«è¨ˆç®—ã—ã¦ $u$ ã‚’ãƒ¢ãƒ‹ãƒƒã‚¯ã¨ã™ã‚‹ã€‚
>
> $$
\begin{aligned}
u' & = \frac{f - vh - v^2}{u} \\
v' & = - h - v & \pmod{u'}
\end{aligned}
$$

æ¥•å††æ›²ç·šã®å ´åˆã¨åŒæ§˜ã«è¶…æ¥•å††æ›²ç·šã®ä½æ•°ã«ã¤ã„ã¦æ¬¡ã®ã‚ˆã†ãªå®šç†ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

> **Thm. è¶…æ¥•å††æ›²ç·šã®ä½æ•°ã®ç¯„å›²**
>
> $$
(\sqrt{p}-1)^{2g} \leq \#\mathcal{J}_C(\mathbb{F}_p) \leq (\sqrt{p}+1)^{2g}
$$

$\#\mathcal{J}_C(\mathbb{F}_p) \approx p^g$

åŒæ§˜ã«è¶…æ¥•å††æ›²ç·šã«ã‚‚ãã®ä½æ•°ã«é–¢ä¿‚ã™ã‚‹ãƒ•ãƒ­ãƒ™ãƒ‹ã‚¦ã‚¹å†™åƒã®ç‰¹æ€§å¤šé …å¼ãŒã‚ã‚Šã€$l$ ç­‰åˆ†å¤šé …å¼ã‚’ç”¨ã„ã¦ $l$ ç­‰åˆ†ç‚¹ã‚’ç”Ÿæˆã—ã¦ Schoof ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é©ç”¨ã™ã‚Œã°ä½æ•°ãŒæ±‚ã¾ã‚Šã¾ã™ã€‚


è¢«ç´„å› å­

$$
\mathcal{D} = \sum_im_iP_i - \left(\sum_im_i\right)P_\infty
$$

$$
\mathcal{D} = \begin{cases}
0 \\
P_1 - P_\infty \\
2P_1 - 2P_\infty \\
P_1 + P_2 - 2P_\infty
\end{cases}
$$

## æ¥•å††é–¢æ•°ã¨æ¥•å††æ›²ç·šã¨æ¥•å††ç©åˆ†ã®é–¢ä¿‚

æ¥•å††æ›²ç·šä¸Šã®ç‚¹å…¨ä½“ã«åŠ ãˆã¦ãã®æ›²ç·šä¸Šã«å­˜åœ¨ã™ã‚‹ã¨è€ƒãˆãŸã„ãã‚ã‚ã¦é‡è¦ãªç„¡é™é ç‚¹ã¨å‘¼ã°ã‚Œã‚‹ã‚‚ã®ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯è¤‡ç´ é–¢æ•°è«–ã«ãŠã„ã¦ã€è¤‡ç´ å¹³é¢ã«ç„¡é™é ç‚¹ã‚’æ·»åŠ ã—ã¦ãƒªãƒ¼ãƒãƒ³çƒé¢ã‚’å½¢æˆã™ã‚‹ã“ã¨ã¨åŒã˜ã‚ˆã†ãªã‚‚ã®ã§ã™ã€‚

ã“ã®ã“ã¨ã‚’æ­£ç¢ºã«æ‰±ã†ç‚ºã«ã¯ä½“ $k$ ä¸Šã® 3 æ¬¡å…ƒã‚¢ãƒ•ã‚£ãƒ³ç©ºé–“ $\mathbb{A}_k^3$ ã®åŒå€¤é¡ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹å°„å½±å¹³é¢ $\mathbb{P}_k^2$ ã®å…ƒ $(x:y:z)$ ã‚’åº§æ¨™ã¨å®šç¾©ã—ã¾ã™ãŒã€æœ¬è³ªçš„ã§ã¯ãªã„ã®ã§è©³ç´°ã¯çœãã¾ã™ã€‚ $(x/z, y/z) := (x:y:z)$ ã¨å¯¾å¿œã™ã‚‹ã¨è€ƒãˆã‚Œã°ã‚ˆã„ã§ã™ã€‚ã“ã“ã§ç„¡é™é ç‚¹ $\mathcal{O}$ ã‚’ $(1:0:0)$ ã¨å®šç¾©ã—ã¾ã™ã€‚

**Proof.**
ã¾ãšæ¥•å††é–¢æ•°ã‚’å®šç¾©ã™ã‚‹ã€‚

> **Def. æ¥•å††é–¢æ•°**
> è¤‡ç´ å¹³é¢ä¸Šã®æ ¼å­ $L$ ã‚’å‘¨æœŸã¨ã™ã‚‹é–¢æ•°ã‚’æ¥•å††é–¢æ•°ã¨ã„ã†ã€‚
>
> $$
\forall z\in\mathbb{C}, \forall \omega\in L, f(z + \omega) = f(z)
$$

ã¨ã“ã‚ã§ Weierstrass ã® $\wp$ é–¢æ•°ã¨ã„ã†ã‚‚ã®ãŒã‚ã‚‹ã€‚

ã‚ã‚‹ç·šå½¢ç‹¬ç«‹ãªè¤‡ç´ æ•° $\omega_1, \omega_2\in \mathbb{C}$ ã«å¯¾ã—ã€æ ¼å­ $L = \mathbb{Z}\omega_1 + \mathbb{Z}\omega_2$ ã‚’æ§‹æˆã™ã‚‹ã€‚ã“ã®ã¨ã Weierstrass ã® $\wp$ é–¢æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã™ã‚‹ã€‚

$$
\wp(z) = \wp(z, L) = \frac{1}{z^2} + \sum_{\substack{\omega\in L \\ \omega \neq 0}}\left(\frac{1}{(z - \omega)^2} - \frac{1}{\omega^2}\right)
$$

ã¾ãŸ $z$ ã«é–¢ã—ã¦å¾®åˆ†ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ã«ãªã‚‹ã€‚

$$
\begin{aligned}
\wp'(z) & = - 2\sum_{\omega\in L}\frac{1}{(z - \omega)^3} \\
\end{aligned}
$$

ã“ã®ã¨ã $\wp(z), \wp'(z)$ ãŒåæŸã™ã‚‹ã“ã¨ã‚’ç¤ºã™ã€‚ç·å’Œã®ä¸­èº«ã¯ $\omega \gg z$ ã«ãŠã„ã¦æ¬¡ã®ã‚ˆã†ã«è¿‘ä¼¼ã§ãã‚‹ã€‚

$$
\begin{aligned}
\left|\frac{1}{(z - \omega)^2} - \frac{1}{\omega^2}\right| & = \left|\frac{z^2 - 2\omega z}{(z - \omega)^2\omega^2} \right| \approx \frac{1}{|\omega|^3} \\
\left|\frac{1}{(z - \omega)^3}\right| & \approx \frac{1}{|\omega|^3}
\end{aligned}
$$

ã“ã‚Œã‚ˆã‚Šç·å’Œã‚’å–ã£ã¦ã‚‚ $1/|\omega|$ ç¨‹åº¦ã§ã‚ã‚‹ã‹ã‚‰ $\wp(z), \wp'(z)$ ã¯çµ¶å¯¾åæŸã™ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚‹ã€‚ã¾ãŸ $\wp(z), \wp'(z)$ ã¯ç·å’Œã‚’å–ã£ã¦ã„ã‚‹ã®ã§æ¥•å††é–¢æ•°ã§ã‚ã‚‹ã€‚
ã“ã“ã§è‰²ã€…è¨ˆç®—ã™ã‚‹ã¨æ¬¡ã®ã‚ˆã†ãªé–¢ä¿‚å¼ãŒæˆã‚Šç«‹ã¤ã€‚

$$
(\wp'(z))^2 = 4\wp^3 - 60\bigg(\sum_{\substack{\omega\in L \\ \omega \neq 0}}\frac{1}{\omega^4}\bigg)\wp - 140\bigg(\sum_{\substack{\omega\in L \\ \omega \neq 0}}\frac{1}{\omega^6}\bigg)
$$

ã“ã‚Œã‚‰ã®ä¿‚æ•°ãŒåæŸã™ã‚‹ã“ã¨ã¯æ˜ã‚‰ã‹ãªã®ã§ $g_2, g_3$ ã¨ãŠãã€‚ã“ã“ã§ $(\wp(z), \wp'(z))$ ã‚’å¹³é¢ä¸Šã®ç‚¹ã¨è¦‹ç«‹ã¦ãŸæ›²ç·šã¯ (éç‰¹ç•°ãª) æ¥•å††æ›²ç·šã¨ãªã‚‹ã€‚

$$
y^2 = 4x^3 - g_2x - g_3
$$