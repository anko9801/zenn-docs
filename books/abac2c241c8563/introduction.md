---
title: "Introduction"
---

## 話すこと
CTF で Crypto が解けるようになるだけではなく最新の暗号研究に追い付く為に必要な知識も解説していきたいと思います。

Crypto は CTF 特有の発想力よりかは数学色、パズル色が強いです。

私もすべて理解している訳ではないので知っていることだけを紹介します。

アニメと同じく12話構成です。実質アニメなんじゃないでしょうか？

それではどうぞアニメライフをごゆっくりとお楽しみください。

### 対象読者
対象者によって読む所が違うように工夫したので長いなと感じたらこれを参考にするといいかもしれません。
- 暗号自体を軽く調べたい方
  - Introduction と暗号プロトコルについて読むと幸せになれます。
- Crypto を解けるようになりたい方
  - Introduction、RSA暗号への攻撃、楕円曲線暗号への攻撃を読むと幸せになれます。
- 数学が好きな方
  - 暗号技術を支える計算機代数から準同型暗号までを読むと幸せになれます。
- 暗号に強い興味がある方
  - 全部読もう！

### 前提知識
- (必須) 線形代数の基礎的な知識
- (必須) Python の基礎的な構文
- (あるとよい) 群環体などの代数学
- (より理解したい方向け) 代数幾何学や楕円曲線論

### 目標
- CTF の Crypto で難しい問題が解けるようになる
- 最新の暗号研究を追うことができるようになる

暗号の専門家ではないし、情報の専門家ですらないので不適切な表現があればご指摘いただけると幸いです。

## 暗号の歴史

1969年 ARPANET

共通鍵暗号
暗号化と復号で **同じ鍵** を使い、暗号化で使う鍵を **秘密** にする方式
ex.) DES, AES, ChaCha20

- DES
  - 最初に標準化された共通鍵暗号
- Triple-DES
  - DES の脆弱性を受けて改良したもの
- AES
  - 現代の共通鍵暗号の標準

公開鍵暗号
暗号化と復号で **別の鍵** を使い、暗号化で使う鍵を **公開** する方式
ex.) RSA暗号, Rabin暗号

- RSA暗号
- 楕円曲線暗号

DH鍵共有
公開鍵暗号を用いて共通鍵暗号を渡すプロトコル

TLS/SSL
HTTPS や SMTPS などで使用されている暗号プロトコル

1995年 SSL 3.0 が公開
- Netscape Communications 社が開発
1999年 TLS 1.0 の制定
- 国際標準化の為に SSL から名称変更
- 既に SSL という名称が定着していた為、SSL という名前も残る
SSL は TLS の前身で現在は使用されていない。

## 暗号とは

暗号というのは悪いことをさせない機構です。

通信時に悪いことが出来ないとは具体的に何でしょうか？

- 機密性 (Confidentiality)
平文に関するあらゆる情報を得られない
- 完全性 (Integrity)
改ざんされない
- 真正性 (Authenticity)
なりすまされない

逆に「解読、改ざん、なりすまし」が出来なければ、悪いことが出来ないということが証明されます。(要出典) exploit はどうなん

### 解読されないとは
ある暗号に機密性があるというのを拡大解釈すると「**暗号化は簡単でも復号は難しい**」という非対称性があるということが言えます。

例えば RSA 暗号であれば「掛け算は簡単でも素因数分解は難しい」という非対称性、AES であれば「シャッフルは簡単でも元に戻すのは難しい」という非対称性、ルービックキューブであれば「スクランブルするのは簡単でも色を揃えるのは難しい」という非対称性があります。

このような難しさの非対称性を見つけられれば暗号を構成することができます。

TODO: 具体例

ただ機密性というのは「平文に関するあらゆる情報を得られない」ことなので平文を 1 ビット足りとも漏らしてはいけませんし、あるビット列が暗号文であるかどうかさえも分からないようにしないといけません。それらが証明されたとき、その暗号は機密性のある暗号と言えます。

### 改ざんされないとは
まず先に断っておくのですが、本質的に改ざんさせないということは不可能です。通信を覗いて暗号文を適当に書き換えたものを送りつければ、平文も書き換わりますからね。

それでは改ざんされることは許すとして、改ざんされたことを検知することができれば十分じゃないでしょうか。

ハッシュ関数

他にも検知する方法はありますが基本的にハッシュ関数をベースに作られています。これらも後で解説します。

- MAC; Message Authentication Code
- AEAD; Authenticated Encryption with Associated Data

### なりすまされないとは
信頼できない相手をどのように正当性を担保するのかというのは現代でよくあります。

皆さんがよく使う **パスワード認証** はなりすましを防ぐ手段の 1 つです。
合言葉であるパスワードを知っている人しかログインできないようにすれば、ユーザーの正当性は大体担保できます。これはユーザーにとって分かりやすいシステムな反面、パスワードが使い回されていたり、簡潔なものに設定されているなどしていると、アカウントが乗っ取られてしまうことがあります。ですのでちゃんとそれぞれ違う複雑なパスワードを設定する...なんてことは僕には無理で FIDO かブラウザが生成した乱数値を使うのがいいでしょう。

パスワード認証の他に **デジタル署名** というのもあります。
簡単に言えば合言葉という概念を公開鍵を使って実現する方法です。
デジタル署名というのは「秘密鍵で署名をして、公開鍵で検証できる」
署名とは認証局 (CA) の鍵を信用し、CA によって署名された証明書を持つユーザーを認証する方式です。

SSH の公開鍵認証ってしたことありますか？公開鍵を `authorized_keys` に書いて `ssh` コマンド叩いて `fingerprint` がなんとかかんとかとか言われたりして接続できるやつ。あれは CA が接続するユーザーと同一人物のときのデジタル署名で、自分自身で署名を発行してホストに検証してもらうという認証をしています。

最近その手の話題はよくあって詳しい解説は他の記事に任せます。traP とかいうサークルが解説記事いっぱい出してるんじゃないですかね。

- MFA; Multi-Factor Authentication / 2FA
- OAuth2.0 / OpenID Connect
- WebAuthn / FIDO

なりすましを中間者攻撃 (Man in the middle) とも言います。

## あそんでみよう
実際の CTF ではよくわからない暗号やエンコーディング、古典暗号が出題されることがあるのですが、大抵 CyberChef に投げれば解けてしまいます。

https://gchq.github.io/CyberChef/

https://quipqiup.com/

:::message
**練習問題**
CyberChef で遊んでみよう
- RSA 暗号
- Base64
- 署名
- 鍵共有
- エニグマ
:::

## 参考文献
- https://letsencrypt.org/docs/challenge-types/